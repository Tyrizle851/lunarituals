<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Luna Rituals ‚Äî Elevate Your Space & Mind</title>
  <meta name="description" content="Luna Rituals offers AI‚Äëcrafted affirmation prints, journals, and mood bundles in soft, earthy aesthetics. Elevate your space & mind with minimalist designs and calming rituals." />
  <meta name="theme-color" content="#e9e5df" />
  <!-- Open Graph -->
  <meta property="og:title" content="Luna Rituals ‚Äî Elevate Your Space & Mind" />
  <meta property="og:description" content="AI‚Äëcrafted affirmation prints, journals, and mood bundles in soft, earthy aesthetics." />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="https://tyrizle851.github.io/lunarituals/assets/logo.png" />
  <meta property="og:url" content="https://tyrizle851.github.io/lunarituals/" />
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Marcellus&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
  <link rel="canonical" href="https://tyrizle851.github.io/lunarituals/">
  <link rel="icon" href="favicon.ico">
  <!-- TikTok-optimized meta tags -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Luna Rituals ‚Äî Custom AI Affirmation Prints" />
  <meta name="twitter:description" content="Create personalized affirmation art for your space. Instant download. $6.99+" />
  <meta name="twitter:image" content="https://tyrizle851.github.io/lunarituals/assets/logo.png" />
  <!-- Mobile app banner (if/when you have an app) -->
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <meta name="apple-mobile-web-app-title" content="Luna Rituals" />
  <!-- TikTok Pixel (when ready for TikTok Shop) -->
  <!-- <script src="assets/tiktok-pixel.js"></script> -->

  <!-- OpenAI API Configuration -->
  <script>
    // Replace with your actual OpenAI API key
    const OPENAI_API_KEY = 'YOUR_OPENAI_API_KEY_HERE';
  </script>
  <style>
    :root{
      /* Soft earthy palette */
      --sand:#e9e5df; /* background */
      --cream:#f8f6f3; /* cards */
      --sage:#b9c2b0; /* accents */
      --olive:#7b8d6a; /* buttons */
      --clay:#b8856a; /* highlights */
      --charcoal:#2e2c2a; /* text */
      --ink:#47433f; /* secondary text */
      --radius:18px;
      --shadow:0 10px 24px rgba(0,0,0,.08);
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:var(--sand);color:var(--charcoal);font-family:Inter,system-ui,Segoe UI,Arial,sans-serif;}
    a{color:inherit;text-decoration:none}
    .wrap{max-width:1100px;margin:0 auto;padding:28px}
    header{position:sticky;top:0;background:rgba(233,229,223,.85);backdrop-filter:saturate(140%) blur(8px);z-index:20;border-bottom:1px solid rgba(0,0,0,.04)}
    .nav{display:flex;align-items:center;justify-content:space-between;gap:14px}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{height:32px;width:auto;display:block}
    .brand h1{font-family:Marcellus,serif;font-size:20px;letter-spacing:.5px;margin:0}
    .nav a.btn{padding:10px 14px;border-radius:999px;border:1px solid rgba(0,0,0,.06);background:var(--cream)}
  .cart-btn{display:inline-flex;align-items:center;gap:8px}
  .badge{display:inline-flex;align-items:center;justify-content:center;min-width:18px;height:18px;padding:0 6px;border-radius:999px;background:var(--olive);color:#fff;font-size:12px;font-weight:700}
    .hero{display:grid;grid-template-columns:1.1fr .9fr;gap:28px;align-items:center;padding:64px 0}
    .card{background:var(--cream);border-radius:var(--radius);box-shadow:var(--shadow);border:1px solid rgba(0,0,0,.05)}
    .hero .panel{padding:28px}
    .eyebrow{color:var(--olive);font-weight:600;font-size:12px;letter-spacing:.12em;text-transform:uppercase}
    .headline{font-family:Marcellus,serif;font-size:46px;line-height:1.05;margin:10px 0 10px}
    .sub{color:var(--ink);font-size:16px;line-height:1.6}
    .cta{display:flex;gap:12px;margin-top:18px}
    .btn-primary{background:var(--olive);color:#fff;border:none;padding:12px 16px;border-radius:999px;box-shadow:0 6px 16px rgba(123,141,106,.25);font-weight:600}
    .btn-ghost{background:transparent;border:1px solid rgba(0,0,0,.12);padding:12px 16px;border-radius:999px}
    .mock{height:380px;border-radius:var(--radius);overflow:hidden;position:relative}
    .mock svg{width:100%;height:100%;display:block}
    .section{padding:24px 0 12px}
    h2{font-family:Marcellus,serif;font-size:28px;margin:0 0 10px}
    p.lead{color:var(--ink)}
    .features{display:grid;grid-template-columns:repeat(3,1fr);gap:18px;margin-top:18px}
    .feature{padding:18px}
    .feature h3{margin:8px 0 6px;font-size:18px}
    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:18px}
  .product{display:flex;flex-direction:column;overflow:hidden;cursor:pointer;transition:transform .15s ease, box-shadow .15s ease}
  .product:hover{transform:translateY(-2px);box-shadow:var(--shadow)}
    .media{aspect-ratio:4/5;background:linear-gradient(180deg,#f7f5f1, #e5e1da);display:grid;place-items:center}
    .tag{position:absolute;top:10px;left:10px;background:rgba(123,141,106,.9);color:#fff;font-size:12px;padding:6px 10px;border-radius:999px}
    .pbody{padding:14px}
    .pname{font-weight:600}
    .pdesc{color:var(--ink);font-size:14px;margin:6px 0 10px}
    .price{font-weight:700}
    .filterbar{display:flex;gap:10px;flex-wrap:wrap;margin:14px 0}
    .chip{border:1px solid rgba(0,0,0,.1);background:#fff;padding:8px 12px;border-radius:999px;cursor:pointer}
    .chip.active{background:var(--olive);color:#fff;border-color:transparent}
    .testimonials{display:grid;grid-template-columns:repeat(3,1fr);gap:18px}
    .quote{padding:18px;font-size:15px;color:var(--ink)}
    .signup{display:grid;grid-template-columns:1.2fr .8fr;gap:18px;align-items:center;margin-top:10px}
    .signup form{display:flex;gap:10px}
    input[type=email]{flex:1;padding:12px 14px;border-radius:999px;border:1px solid rgba(0,0,0,.12);background:#fff}
    button[type=submit]{padding:12px 16px;border-radius:999px;border:none;background:var(--clay);color:#fff;font-weight:700}
    footer{margin-top:40px;padding:28px 0;border-top:1px solid rgba(0,0,0,.06);color:var(--ink)}

    /* Responsive */
    @media (max-width: 900px){
      .hero{grid-template-columns:1fr}
      .features,.grid,.testimonials,.signup{grid-template-columns:1fr}
    }

  /* Modal and Generator */
  .modal{position:fixed;inset:0;display:none;z-index:1000}
  .modal.open{display:block}
  .modal .backdrop{position:absolute;inset:0;background:rgba(46,44,42,.85);-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);animation:fadeIn .2s ease-out}
  .modal-card{position:relative;background:#fff;border-radius:24px;max-width:900px;max-height:80vh;margin:40px auto;overflow:auto;box-shadow:var(--shadow);transform:scale(.95);opacity:0;animation:cardIn .25s ease-out forwards}
  .modal-close{position:absolute;top:12px;right:12px;width:44px;height:44px;border:none;background:#fff;border-radius:999px;box-shadow:0 2px 10px rgba(0,0,0,.12);cursor:pointer;font-size:20px;display:grid;place-items:center;z-index:1002}
  .gen-grid{display:grid;grid-template-columns:40% 40% 20%;gap:18px;padding:28px;grid-template-areas:"left center right"}
  .gen-left{min-width:0;grid-area:left}
  .gen-center{min-width:0;grid-area:center}
  .gen-right{min-width:0;grid-area:right}
  .gen-title{font-family:Marcellus,serif;font-size:32px;margin:0 0 10px}
  .label{font-size:13px;color:var(--ink);margin:10px 0 6px;display:block}
  .control{width:100%;padding:18px 16px;border:1px solid rgba(0,0,0,.12);border-radius:12px;background:#fff;font:inherit;transition:all .15s ease}
  .control:focus{outline:none;border-color:transparent;box-shadow:0 0 0 2px var(--olive)}
  .choice-row{display:flex;gap:10px;flex-wrap:wrap}
  .radio{display:flex;gap:8px;align-items:center;padding:12px 14px;border:1px solid rgba(0,0,0,.12);border-radius:12px;cursor:pointer;min-height:48px}
  .chips{display:flex;gap:10px;flex-wrap:wrap}
  .chip-swatch{width:40px;height:40px;border-radius:999px;border:2px solid transparent;cursor:pointer}
  .chip-swatch[aria-checked="true"]{border-color:#222}
  .swatch-sage{background:#b9c2b0}
  .swatch-olive{background:#7b8d6a}
  .swatch-clay{background:#b8856a}
  .swatch-mix{background:linear-gradient(45deg,#b9c2b0 0%,#7b8d6a 50%,#b8856a 100%)}
  .error{color:#dc2626;font-size:14px;margin-top:6px}
  .help{color:var(--ink);opacity:.7;font-size:14px;margin-bottom:8px}
  .gen-actions{display:flex;flex-direction:column;gap:10px}
  .btn-ghost-wide{background:transparent;border:1px solid rgba(0,0,0,.12);padding:0 16px;border-radius:999px;font-weight:600;height:48px}
  .btn-primary-wide{background:var(--olive);color:#fff;border:none;padding:0 20px;border-radius:999px;font-weight:600;box-shadow:0 4px 12px rgba(123,141,106,.3);cursor:pointer;height:56px}
  .btn-primary-wide:disabled{opacity:.5;cursor:not-allowed}
  .btn-primary-wide:hover{transform:translateY(-2px);box-shadow:0 6px 16px rgba(123,141,106,.35)}
  .btn-primary-wide:active{transform:translateY(0)}
  .price-lg{font-weight:800;font-size:28px}
  .preview-wrap{display:flex;flex-direction:column;gap:8px}
  .preview-label{font-size:14px;color:var(--ink);opacity:.7}
  .preview-area{aspect-ratio:4/5;background:linear-gradient(180deg,#f7f5f1,#e5e1da);border-radius:12px;display:grid;place-items:center;overflow:hidden}
  .fade-enter{animation:fadeIn .3s ease both}
  .fade-exit{animation:fadeOut .3s ease both}
  .spinner{width:40px;height:40px;border:3px solid rgba(0,0,0,.1);border-top-color:var(--olive);border-radius:50%;animation:spin 1s linear infinite}
  .success{color:#2f855a;font-size:14px}
  .preview-msg{font-size:14px}
  @keyframes spin{to{transform:rotate(360deg)}}
  @keyframes fadeIn{from{opacity:0}to{opacity:1}}
  @keyframes fadeOut{from{opacity:1}to{opacity:0}}
  @keyframes cardIn{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}
  @keyframes shakeKey{0%{transform:translateX(0)}25%{transform:translateX(-10px)}50%{transform:translateX(10px)}75%{transform:translateX(-6px)}100%{transform:translateX(0)}}
  .shake{animation:shakeKey .4s}
  /* Toast */
  .toast{position:fixed;right:16px;bottom:16px;background:#fff;border:1px solid rgba(0,0,0,.08);box-shadow:var(--shadow);border-radius:12px;padding:12px 14px;z-index:1100;display:none}
  .toast.show{display:block;animation:fadeIn .2s ease-out}
  /* Responsive modal */
  @media (max-width: 1023px){
    .modal-card{max-width:90vw;max-height:85vh}
    .gen-grid{grid-template-columns:1.2fr .8fr;grid-template-areas:'center left' 'center right';padding:32px}
  }
  @media (max-width: 767px){
    .modal-card{width:100vw;height:100vh;margin:0;border-radius:0;max-height:100vh;padding-top:max(16px, env(safe-area-inset-top));padding-bottom:max(16px, env(safe-area-inset-bottom))}
    .modal-close{top:max(12px, env(safe-area-inset-top))}
    .gen-grid{grid-template-columns:1fr;grid-template-areas:'center' 'right' 'left';padding:16px}
    .preview-wrap{order:1;position:sticky;top:0;background:#fff;padding-bottom:8px;z-index:1}
    }
  </style>
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "Luna Rituals",
    "url": "https://tyrizle851.github.io/lunarituals/",
    "logo": "https://tyrizle851.github.io/lunarituals/assets/logo.png",
    "sameAs": []
  }
  </script>
</head>
<body>
  <header>
    <div class="wrap nav">
      <div class="brand">
    <img src="assets/logo.png" alt="Luna Rituals logo" class="logo" />
        <h1>Luna Rituals</h1>
      </div>
    <nav>
        <a class="btn" href="#shop">Shop</a>
        <a class="btn" href="blog.html">Blog</a>
        <a class="btn" href="#about">About</a>
        <a class="btn" href="#signup">Sign up</a>
        <a class="btn cart-btn" href="#" id="cartBtn" aria-label="Cart">
          <span>Cart</span>
          <span class="badge" id="cartBadge" aria-live="polite">0</span>
        </a>
    </nav>
    </div>
  </header>

  <main class="wrap">
    <!-- Hero -->
    <section class="hero">
      <div class="panel card">
        <div class="eyebrow">From TikTok? Welcome! üëã ‚Ä¢ Soft ‚Ä¢ Earthy ‚Ä¢ Minimal</div>
        <h2 class="headline">Create your custom affirmation.</h2>
        <p class="sub">Personalized AI‚Äëcrafted prints, journals, and mood bundles. Preview before you buy. Instant download.</p>
        <div class="cta">
          <a class="btn-primary" href="#shop" onclick="document.querySelectorAll('.product')[0].click(); return false;">‚ú® Start Customizing</a>
          <a class="btn-ghost" href="#about">How it works</a>
        </div>
      </div>
      <div class="panel">
        <div class="mock card" aria-label="Preview of Luna Rituals products">
          <!-- Minimal illustrated mock (SVG) -->
          <svg viewBox="0 0 800 600" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Earthy abstract mockup">
            <defs>
              <linearGradient id="g1" x1="0" y1="0" x2="0" y2="1">
                <stop offset="0%" stop-color="#f8f6f3"/>
                <stop offset="100%" stop-color="#e9e5df"/>
              </linearGradient>
            </defs>
            <rect width="800" height="600" fill="url(#g1)"/>
            <rect x="80" y="70" width="280" height="420" rx="18" fill="#ffffff" stroke="#e1ddd6"/>
            <circle cx="220" cy="210" r="70" fill="#b9c2b0"/>
            <rect x="120" y="320" width="200" height="14" rx="7" fill="#7b8d6a"/>
            <rect x="120" y="346" width="170" height="10" rx="5" fill="#b8856a"/>
            <rect x="420" y="120" width="280" height="360" rx="18" fill="#ffffff" stroke="#e1ddd6"/>
            <rect x="460" y="190" width="200" height="120" rx="12" fill="#e9e5df"/>
            <rect x="460" y="330" width="150" height="12" rx="6" fill="#7b8d6a"/>
            <rect x="460" y="352" width="120" height="10" rx="5" fill="#b8856a"/>
          </svg>
        </div>
      </div>
    </section>

    <!-- Why it works -->
    <section id="about" class="section">
      <h2>Designed for calm focus</h2>
      <p class="lead">We pair gentle typography, soft earthy palettes, and evidence‚Äëbacked prompts to nudge daily consistency. Every piece is minimalist by design and crafted to look beautiful in your space.</p>
      <div class="features">
        <div class="feature card">
          <strong>Minimalist Aesthetic</strong>
          <p>Neutral textures and soft sage accents that pair with any interior style.</p>
        </div>
        <div class="feature card">
          <strong>AI‚ÄëCrafted Prompts</strong>
          <p>Curated affirmations and journal frameworks generated and refined with AI.</p>
        </div>
        <div class="feature card">
          <strong>Instant Download</strong>
          <p>Print at home or use digitally. Your files arrive seconds after purchase.</p>
        </div>
      </div>
    </section>

    <!-- Shop -->
    <section id="shop" class="section">
      <h2>Collections</h2>
      <p class="lead">Browse our first drop. Checkout will be enabled soon ‚Äî for now, explore styles and sign up for the launch.</p>

      <div class="filterbar">
        <button class="chip active" data-filter="all">All</button>
        <button class="chip" data-filter="prints">Affirmation Prints</button>
        <button class="chip" data-filter="journals">Journals</button>
        <button class="chip" data-filter="bundles">Mood Bundles</button>
      </div>

      <div class="grid" id="productGrid">
        <!-- Product 1 -->
        <article class="product card" data-cat="prints">
          <div class="media" aria-label="Serene affirmation print preview">
            <span class="tag">Print</span>
            <svg viewBox="0 0 400 500" xmlns="http://www.w3.org/2000/svg" role="img">
              <rect width="400" height="500" fill="#f7f5f1"/>
              <circle cx="200" cy="170" r="70" fill="#b9c2b0"/>
              <rect x="100" y="280" width="200" height="12" rx="6" fill="#7b8d6a"/>
              <rect x="120" y="305" width="160" height="10" rx="5" fill="#b8856a"/>
            </svg>
          </div>
          <div class="pbody">
            <div class="pname">Serene Intentions</div>
            <div class="pdesc">A minimalist affirmation print to anchor your morning ritual.</div>
            <div class="price">$6.99</div>
          </div>
        </article>

        <!-- Product 2 -->
        <article class="product card" data-cat="journals">
          <div class="media" aria-label="Daily reset journal preview">
            <span class="tag">Journal</span>
            <svg viewBox="0 0 400 500" xmlns="http://www.w3.org/2000/svg" role="img">
              <rect width="400" height="500" fill="#f7f5f1"/>
              <rect x="90" y="130" width="220" height="240" rx="12" fill="#e9e5df"/>
              <rect x="110" y="160" width="180" height="12" rx="6" fill="#7b8d6a"/>
              <rect x="110" y="185" width="140" height="10" rx="5" fill="#b8856a"/>
            </svg>
          </div>
          <div class="pbody">
            <div class="pname">Daily Reset Journal</div>
            <div class="pdesc">A guided 7‚Äëminute flow for clarity, gratitude, and intention‚Äësetting.</div>
            <div class="price">$12.99</div>
          </div>
        </article>

        <!-- Product 3 -->
        <article class="product card" data-cat="bundles">
          <div class="media" aria-label="Calm mornings bundle preview">
            <span class="tag">Bundle</span>
            <svg viewBox="0 0 400 500" xmlns="http://www.w3.org/2000/svg" role="img">
              <rect width="400" height="500" fill="#f7f5f1"/>
              <rect x="60" y="110" width="280" height="70" rx="10" fill="#e9e5df"/>
              <rect x="60" y="200" width="280" height="70" rx="10" fill="#e9e5df"/>
              <rect x="60" y="290" width="280" height="70" rx="10" fill="#e9e5df"/>
            </svg>
          </div>
          <div class="pbody">
            <div class="pname">Calm Mornings Bundle</div>
            <div class="pdesc">Three coordinated prints + a micro‚Äëjournal to set tone for the day.</div>
            <div class="price">$12.99</div>
          </div>
        </article>

        <!-- Product 4 -->
        <article class="product card" data-cat="prints">
          <div class="media" aria-label="Grounded mantras print preview">
            <span class="tag">Print</span>
            <svg viewBox="0 0 400 500" xmlns="http://www.w3.org/2000/svg" role="img">
              <rect width="400" height="500" fill="#f7f5f1"/>
              <rect x="100" y="150" width="200" height="12" rx="6" fill="#7b8d6a"/>
              <rect x="120" y="175" width="160" height="10" rx="5" fill="#b8856a"/>
              <circle cx="200" cy="300" r="70" fill="#b9c2b0"/>
            </svg>
          </div>
          <div class="pbody">
            <div class="pname">Grounded Mantras</div>
            <div class="pdesc">Set of three mantras for focus, momentum, and gentle discipline.</div>
            <div class="price">$6.99</div>
          </div>
        </article>

        <!-- Product 5 -->
        <article class="product card" data-cat="journals">
          <div class="media" aria-label="Evening unwind journal preview">
            <span class="tag">Journal</span>
            <svg viewBox="0 0 400 500" xmlns="http://www.w3.org/2000/svg" role="img">
              <rect width="400" height="500" fill="#f7f5f1"/>
              <rect x="90" y="140" width="220" height="70" rx="12" fill="#e9e5df"/>
              <rect x="90" y="230" width="220" height="70" rx="12" fill="#e9e5df"/>
              <rect x="90" y="320" width="220" height="70" rx="12" fill="#e9e5df"/>
            </svg>
          </div>
          <div class="pbody">
            <div class="pname">Evening Unwind Journal</div>
            <div class="pdesc">A soft‚Äëlanding journaling flow to release, reflect, and restore.</div>
            <div class="price">$11.99</div>
          </div>
        </article>

        <!-- Product 6 -->
        <article class="product card" data-cat="bundles">
          <div class="media" aria-label="Focus week bundle preview">
            <span class="tag">Bundle</span>
            <svg viewBox="0 0 400 500" xmlns="http://www.w3.org/2000/svg" role="img">
              <rect width="400" height="500" fill="#f7f5f1"/>
              <rect x="70" y="120" width="260" height="240" rx="14" fill="#e9e5df"/>
              <rect x="100" y="160" width="200" height="12" rx="6" fill="#7b8d6a"/>
              <rect x="100" y="185" width="150" height="10" rx="5" fill="#b8856a"/>
            </svg>
          </div>
          <div class="pbody">
            <div class="pname">Focus Week Set</div>
            <div class="pdesc">Planner + affirmation grid + printable tracker for a 7‚Äëday sprint.</div>
            <div class="price">$14.99</div>
          </div>
        </article>
      </div>
    </section>

    <!-- Social proof / Testimonials -->
    <section class="section">
      <h2>What people say</h2>
      <div class="testimonials">
        <div class="quote card">‚ÄúThe prints feel calming without clutter. My desk looks intentional now.‚Äù ‚Äî Aria</div>
        <div class="quote card">‚ÄúThe journal prompts are simple but they actually get me writing.‚Äù ‚Äî Maya</div>
        <div class="quote card">‚ÄúLove the earthy palette. It matches my space perfectly.‚Äù ‚Äî Liv</div>
      </div>
    </section>

    <!-- Email signup -->
    <section id="signup" class="section">
      <h2>Be first to know when checkout opens</h2>
      <div class="signup">
        <p class="lead">Join the list for launch day access, early discounts, and free monthly printables. No spam, just gentle inspiration.</p>
        <form id="subscribeForm">
          <input type="email" name="email" placeholder="Your email" required aria-label="Email address" />
        <button type="submit">Notify me</button>
      </form>
      </div>
    </section>

  <footer>
      <div class="wrap" style="padding:0">
        <div style="display:flex;justify-content:space-between;gap:12px;flex-wrap:wrap">
          <small>¬© <span id="year"></span> Luna Rituals</small>
          <small><a href="#">Pinterest</a> ¬∑ <a href="#">Instagram</a> ¬∑ <a href="#">Contact</a></small>
        </div>
      </div>
  </footer>
  </main>

  <!-- Modal: Custom Generator -->
  <div class="modal" id="generatorModal" aria-hidden="true" role="dialog" aria-modal="true">
    <div class="backdrop" id="modalBackdrop"></div>
    <div class="modal-card" role="document">
      <button class="modal-close" id="modalClose" aria-label="Close">‚úï</button>
      <div class="gen-grid" id="genGrid">
        <!-- Left: Inputs -->
        <section class="gen-left">
          <h2 class="gen-title" id="genTitle">Customize Your Product</h2>
          <p class="help">Personalize the theme and style. You‚Äôll preview before adding to cart.</p>
          <label class="label" for="productType">Product Type</label>
          <div class="choice-row" role="radiogroup" aria-label="Product Type">
            <label class="radio"><input type="radio" name="productType" value="print" checked> Print</label>
            <label class="radio"><input type="radio" name="productType" value="journal"> Journal</label>
            <label class="radio"><input type="radio" name="productType" value="bundle"> Bundle</label>
          </div>

          <label class="label" for="themeInput">Theme / Mood</label>
          <input id="themeInput" class="control" type="text" placeholder="e.g., calm mornings, focused energy" maxlength="100" aria-describedby="themeError" required />
          <div id="themeError" class="error" aria-live="polite" style="display:none"></div>

          <label class="label">Color Preference</label>
          <div class="chips" role="radiogroup" aria-label="Color Preference">
            <button type="button" class="chip-swatch swatch-sage" data-color="sage" role="radio" aria-checked="true" aria-label="Sage"></button>
            <button type="button" class="chip-swatch swatch-olive" data-color="olive" role="radio" aria-checked="false" aria-label="Olive"></button>
            <button type="button" class="chip-swatch swatch-clay" data-color="clay" role="radio" aria-checked="false" aria-label="Clay"></button>
            <button type="button" class="chip-swatch swatch-mix" data-color="mix" role="radio" aria-checked="false" aria-label="Mix"></button>
          </div>

          <label class="label" for="styleSelect">Style</label>
          <select id="styleSelect" class="control" aria-label="Style">
            <option value="minimal" selected>Minimal</option>
            <option value="detailed">Detailed</option>
          </select>

          <label class="label" for="notesInput">Additional Notes</label>
          <textarea id="notesInput" class="control" rows="4" style="min-height:120px"></textarea>

          <button id="generateBtn" class="btn-primary-wide" style="margin-top:10px">Generate Preview</button>
        </section>

        <!-- Center: Preview -->
        <section class="gen-center">
          <div class="preview-wrap">
            <div class="preview-label">Live Preview</div>
            <div class="preview-area" id="previewArea" aria-label="Product preview" aria-busy="false"></div>
            <div id="previewStatus" class="preview-msg" aria-live="polite"></div>
          </div>
        </section>

        <!-- Right: Details & Actions -->
        <aside class="gen-right">
          <h3 style="margin:0 0 10px">Product Details</h3>
          <div class="help">Format: Digital Download<br>Size: 8√ó10" (print‚Äëready)<br>File: High‚Äëres PDF</div>
          <div class="price-lg" id="priceDisplay">$6.99</div>
          <div class="gen-actions" style="margin-top:10px">
            <button id="addToCartBtn" class="btn-primary-wide" disabled>üíö Add to Cart</button>
            <button id="shareTikTokBtn" class="btn-ghost-wide" style="background:#000;color:#fff;border:none" disabled>üì± Share to TikTok</button>
            <button id="regenerateBtn" class="btn-ghost-wide" disabled>‚Üª Regenerate</button>
            <button id="downloadBtn" class="btn-ghost-wide" disabled>‚¨áÔ∏è Download Preview</button>
            <button id="backToShopBtn" class="btn-ghost-wide">‚Üê Back to Shop</button>
          </div>
        </aside>
      </div>
    </div>
  </div>

  <div class="toast" id="toast" role="status" aria-live="polite"></div>

  <script>
    // Year
    document.getElementById('year').textContent = new Date().getFullYear();

    // Simple category filter
    const chips = document.querySelectorAll('.chip');
    const items = document.querySelectorAll('#productGrid .product');
    chips.forEach(ch => ch.addEventListener('click', () => {
      chips.forEach(c=>c.classList.remove('active'));
      ch.classList.add('active');
      const cat = ch.dataset.filter;
      items.forEach(it => {
        const on = cat === 'all' || it.dataset.cat === cat;
        it.style.display = on ? 'flex' : 'none';
      });
    }));

    // Email signup (REAL Formspree integration)
    document.getElementById('subscribeForm').addEventListener('submit', async (e)=>{
          e.preventDefault();
      const email = e.target.email.value.trim();
      if(!email) return;
      const btn = e.target.querySelector('button[type="submit"]');
      const originalText = btn.textContent;
      btn.textContent = 'Subscribing...';
      btn.disabled = true;
      try {
        const response = await fetch('https://formspree.io/f/mvgwndjj', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email: email, source: 'Luna Rituals Website', timestamp: new Date().toISOString() })
        });
        if (response.ok) {
          showToast('‚ú® Welcome! Check your email for a special offer.');
          e.target.reset();
        } else {
          throw new Error('Subscription failed');
        }
      } catch(err) {
        showToast('Oops! Please try again or email us directly.');
        console.error('Formspree error:', err);
      } finally {
        btn.textContent = originalText;
        btn.disabled = false;
      }
    });

    // ---------------------------
    // Modal + Generator (Phase 1)
    // ---------------------------
    const modal = document.getElementById('generatorModal');
    const modalBackdrop = document.getElementById('modalBackdrop');
    const modalClose = document.getElementById('modalClose');
    const genTitle = document.getElementById('genTitle');
    const themeInput = document.getElementById('themeInput');
    const themeError = document.getElementById('themeError');
    const styleSelect = document.getElementById('styleSelect');
    const notesInput = document.getElementById('notesInput');
    const generateBtn = document.getElementById('generateBtn');
    const previewArea = document.getElementById('previewArea');
    const previewStatus = document.getElementById('previewStatus');
    const priceDisplay = document.getElementById('priceDisplay');
    const addToCartBtn = document.getElementById('addToCartBtn');
    const regenerateBtn = document.getElementById('regenerateBtn');
    const backToShopBtn = document.getElementById('backToShopBtn');
    const cartBadge = document.getElementById('cartBadge');
    let activeColor = 'sage';
    let cart = JSON.parse(localStorage.getItem('lunaRitualsCart') || '[]');
    let generating = false;
    let focusTrapStart, focusTrapEnd;
    let lastFocusedCard = null;

    // Make product cards clickable to open modal
    document.querySelectorAll('#productGrid .product').forEach(card => {
      card.setAttribute('role','button');
      card.setAttribute('tabindex','0');
      card.addEventListener('click', () => openModalWith(card));
      card.addEventListener('keypress', (e)=>{ if(e.key==='Enter') openModalWith(card); });
    });

    function openModalWith(card){
      lastFocusedCard = card;
      const name = card.querySelector('.pname')?.textContent?.trim() || 'Product';
      genTitle.textContent = `Customize Your ${name}`;
      // Prefill product type from card tag text
      const tag = card.querySelector('.tag')?.textContent?.toLowerCase() || '';
      const type = tag.includes('journal') ? 'journal' : tag.includes('bundle') ? 'bundle' : 'print';
      const radio = document.querySelector(`input[name="productType"][value="${type}"]`);
      if(radio) radio.checked = true;
      // Prefill theme from product name
      themeInput.value = name;
      // Clear prior state
      previewArea.innerHTML = '';
      previewStatus.textContent = '';
      addToCartBtn.disabled = true;
      regenerateBtn.disabled = true;
      generateBtn.disabled = false;
      validate();
      modal.classList.add('open');
      modal.setAttribute('aria-hidden','false');
      document.body.style.overflow='hidden';
      // Focus trap sentinels
      if(!focusTrapStart){
        focusTrapStart = document.createElement('div');
        focusTrapStart.tabIndex = 0;
        focusTrapEnd = document.createElement('div');
        focusTrapEnd.tabIndex = 0;
        modal.querySelector('.modal-card').prepend(focusTrapStart);
        modal.querySelector('.modal-card').appendChild(focusTrapEnd);
        focusTrapStart.addEventListener('focus', ()=> modalClose.focus());
        focusTrapEnd.addEventListener('focus', ()=> modalClose.focus());
      }
      // Set initial focus to theme input for quick typing
      setTimeout(()=> themeInput.focus(), 0);
    }

    function closeModal(){
      modal.classList.remove('open');
      modal.setAttribute('aria-hidden','true');
      document.body.style.overflow='';
      // Restore focus to last card
      if(lastFocusedCard){ lastFocusedCard.focus(); }
    }

    modalBackdrop.addEventListener('click', closeModal);
    modalClose.addEventListener('click', closeModal);
    document.addEventListener('keydown', (e)=>{
      if(e.key==='Escape' && modal.classList.contains('open')) closeModal();
    });

    // Focus trap within modal
    modal.addEventListener('keydown', (e)=>{
      if(e.key !== 'Tab') return;
      const focusable = modal.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
      const f = Array.from(focusable).filter(el=>!el.hasAttribute('disabled') && el.offsetParent !== null);
      if(f.length===0) return;
      const first = f[0];
      const last = f[f.length-1];
      if(e.shiftKey){
        if(document.activeElement === first){ e.preventDefault(); last.focus(); }
      } else {
        if(document.activeElement === last){ e.preventDefault(); first.focus(); }
      }
    });

    // Color chip selection
    document.querySelectorAll('.chip-swatch').forEach(chip=>{
      chip.addEventListener('click', ()=>{
        document.querySelectorAll('.chip-swatch').forEach(c=>c.setAttribute('aria-checked','false'));
        chip.setAttribute('aria-checked','true');
        activeColor = chip.dataset.color;
      });
    });

    // Validation
    function validate(){
      const val = themeInput.value.trim();
      if(val.length < 3){
        themeError.style.display = 'block';
        themeError.textContent = 'Please enter at least 3 characters.';
        themeInput.setAttribute('aria-invalid','true');
        generateBtn.disabled = true;
        return false;
      }
      if(val.length > 100){
        themeError.style.display = 'block';
        themeError.textContent = 'Keep it under 100 characters.';
        themeInput.setAttribute('aria-invalid','true');
        generateBtn.disabled = true;
        return false;
      }
      themeError.style.display = 'none';
      themeInput.removeAttribute('aria-invalid');
      generateBtn.disabled = false;
      return true;
    }
    themeInput.addEventListener('input', validate);
    // initialize button state
    validate();

    // Real OpenAI API integration for SVG generation
    async function generateAIProduct(productType, theme, colorPref, style, notes){
      const colorMap = {
        sage: '#b9c2b0',
        olive: '#7b8d6a',
        clay: '#b8856a',
        mix: 'linear-gradient(45deg,#b9c2b0 0%,#7b8d6a 50%,#b8856a 100%)'
      };
      const primaryColor = colorMap[colorPref] || colorMap.sage;

      // Craft detailed prompt for OpenAI
      let productPrompt = '';
      if(productType === 'print'){
        productPrompt = `Create a minimalist affirmation print design. Theme: "${theme}". Style: ${style}. Use earthy colors with ${colorPref} as primary accent. Include the theme text prominently. Format as clean SVG code only.`;
      } else if(productType === 'journal'){
        productPrompt = `Design a journal cover with lined paper aesthetic. Theme: "${theme}". Style: ${style}. ${colorPref} color scheme. Include subtle design elements and the theme text. SVG format only.`;
      } else if(productType === 'bundle'){
        productPrompt = `Create a bundle preview showing 3 stacked items (print + journal + card). Theme: "${theme}". Style: ${style}. ${colorPref} color palette. Clean, minimalist design. SVG format only.`;
      }

      if(notes){
        productPrompt += ` Additional notes: ${notes}`;
      }

      productPrompt += ` Generate complete SVG code (viewBox="0 0 600 750") with no explanations. Use earthy, calming colors: background #f7f5f1, accents ${primaryColor}. Include the theme "${theme}" in elegant typography.`;

      try {
        const response = await fetch('https://api.openai.com/v1/chat/completions', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${OPENAI_API_KEY}`
          },
          body: JSON.stringify({
            model: 'gpt-4o-mini',
            messages: [{
              role: 'user',
              content: productPrompt + ' Output ONLY the complete SVG code between <svg> and </svg> tags. No explanations or markdown.'
            }],
            max_tokens: 1000,
            temperature: 0.7
          })
        });

        if (!response.ok) {
          throw new Error(`API Error: ${response.status}`);
        }

        const data = await response.json();
        const svgContent = data.choices[0].message.content.trim();

        // Clean up the SVG content (remove markdown if present)
        const cleanSvg = svgContent.replace(/```svg|```|svg|```/g, '').trim();

        // Ensure it starts and ends with proper SVG tags
        let finalSvg = cleanSvg;
        if (!finalSvg.startsWith('<svg')) {
          finalSvg = `<svg viewBox="0 0 600 750" xmlns="http://www.w3.org/2000/svg">${finalSvg}`;
        }
        if (!finalSvg.endsWith('</svg>')) {
          finalSvg += '</svg>';
        }

        return {
          success: true,
          svg: finalSvg,
          productId: 'ai_' + Date.now(),
          price: productType === 'bundle' ? 14.99 : productType === 'journal' ? 12.99 : 6.99
        };

      } catch (error) {
        console.error('OpenAI API Error:', error);
        // Fallback to mock if API fails
        return generateMockSVG(productType, theme, colorPref);
      }
    }

    // Keep mock as fallback
    function generateMockSVG(type, theme, color){
      const fill = color === 'sage' ? '#b9c2b0' : color === 'olive' ? '#7b8d6a' : color === 'clay' ? '#b8856a' : '#a8b5aa';
      if(type === 'journal'){
        return `<svg viewBox='0 0 600 750' xmlns='http://www.w3.org/2000/svg'>
          <rect width='600' height='750' fill='#f7f5f1'/>
          <rect x='80' y='120' width='440' height='520' rx='12' fill='#e9e5df'/>
          ${Array.from({length:12}).map((_,i)=>`<rect x='100' y='${160+i*36}' width='400' height='2' fill='${fill}' opacity='0.5'/>`).join('')}
          <text x='300' y='120' text-anchor='middle' font-family='Marcellus' font-size='20' fill='#47433f'>${theme}</text>
        </svg>`;
      }
      if(type === 'bundle'){
        return `<svg viewBox='0 0 600 750' xmlns='http://www.w3.org/2000/svg'>
          <rect width='600' height='750' fill='#f7f5f1'/>
          <rect x='90' y='120' width='420' height='140' rx='14' fill='${fill}'/>
          <rect x='90' y='300' width='420' height='140' rx='14' fill='${fill}' opacity='0.8'/>
          <rect x='90' y='480' width='420' height='140' rx='14' fill='${fill}' opacity='0.6'/>
          <text x='300' y='100' text-anchor='middle' font-family='Marcellus' font-size='20' fill='#47433f'>${theme}</text>
        </svg>`;
      }
      // print
      return `<svg viewBox='0 0 600 750' xmlns='http://www.w3.org/2000/svg'>
        <rect width='600' height='750' fill='#f7f5f1'/>
        <circle cx='300' cy='240' r='80' fill='${fill}'/>
        <rect x='180' y='380' width='240' height='14' rx='7' fill='${fill}' opacity='0.9'/>
        <rect x='210' y='410' width='180' height='10' rx='5' fill='${fill}' opacity='0.7'/>
        <text x='300' y='520' text-anchor='middle' font-family='Marcellus' font-size='22' fill='#47433f'>${theme.length>36?theme.slice(0,36)+'‚Ä¶':theme}</text>
      </svg>`;
    }

    // Debounce/cancel token for generation
    let genToken = 0;
    async function generateProduct(productType, theme, colorPref, style, notes){
      const myToken = ++genToken;
      // Fade-out current preview if present
      if(previewArea.firstChild){
        const current = previewArea.firstChild;
        current.classList?.add('fade-exit');
        current.addEventListener('animationend', ()=>{
          if(myToken === genToken) showLoadingSpinner();
        }, { once:true });
        } else {
        showLoadingSpinner();
      }

      // Use real AI instead of mock delay
      let result;
      try {
        result = await generateAIProduct(productType, theme, colorPref, style, notes);
      } catch (error) {
        console.error('AI generation failed, using fallback:', error);
        result = {
          success: true,
          svg: generateMockSVG(productType, theme, colorPref),
          productId: 'fallback_' + Date.now(),
          price: productType === 'bundle' ? 14.99 : productType === 'journal' ? 12.99 : 6.99
        };
      }

      if(myToken !== genToken || !modal.classList.contains('open')){
        // Cancelled or outdated
        return { success:false, cancelled:true };
      }

      return result;
    }

    function showLoadingSpinner(){
      previewArea.innerHTML = `<div class='spinner' aria-hidden='true'></div>`;
      previewArea.setAttribute('aria-busy','true');
      previewStatus.textContent = 'Generating with AI...';
    }
    function showError(){
      previewArea.innerHTML = `<div style="background:#fef2f2;color:#dc2626;padding:12px;border-radius:12px">Couldn't generate preview. Please try again.</div>`;
      previewArea.setAttribute('aria-busy','false');
      previewStatus.textContent = '';
      generateBtn.disabled = false;
      enableInputs(true);
    }
    function showSuccess(svg, price){
      // Fade out existing, then fade in new
      const temp = document.createElement('div');
      temp.innerHTML = svg;
      const child = temp.firstElementChild;
      if(child) child.classList.add('fade-enter');
      previewArea.innerHTML = '';
      previewArea.appendChild(child || document.createTextNode(''));
      previewArea.setAttribute('aria-busy','false');
      previewStatus.textContent = '‚úì Preview ready';
      addToCartBtn.disabled = false;
      regenerateBtn.disabled = false;
      priceDisplay.textContent = `$${price.toFixed(2)}`;
    }

    function enableInputs(on){
      document.querySelectorAll('.control, .radio input, .chip-swatch, #generateBtn').forEach(el=>{
        if(el.id==='generateBtn'){ el.disabled = !on ? true : false; return; }
        el.disabled = !on;
      });
    }

    // Generate button
    generateBtn.addEventListener('click', async ()=>{
      if(generating) return;
      if(!validate()){
        themeInput.classList.add('shake');
        setTimeout(()=>themeInput.classList.remove('shake'),400);
        return;
      }
      generating = true;
      addToCartBtn.disabled = true;
      regenerateBtn.disabled = true;
      enableInputs(false);
      generateBtn.disabled = true;
      const type = (document.querySelector('input[name="productType"]:checked')||{}).value || 'print';
      const theme = themeInput.value.trim();
      const style = styleSelect.value;
      const notes = notesInput.value.trim();
      try{
        const res = await generateProduct(type, theme, activeColor, style, notes);
        if(res.success){
          showSuccess(res.svg, res.price);
          generateBtn.disabled = false;
          } else {
          if(!res.cancelled) showError();
        }
      } catch(e){
        showError();
      } finally {
        generating = false;
        enableInputs(true);
      }
    });

    // Regenerate
    regenerateBtn.addEventListener('click', ()=>{
      if(generateBtn.disabled) return;
      generateBtn.click();
    });

    // Back to shop
    backToShopBtn.addEventListener('click', ()=>{
      closeModal();
      document.getElementById('shop').scrollIntoView({behavior:'smooth'});
    });

    // Add to cart (placeholder)
    function showToast(msg){
      const t = document.getElementById('toast');
      t.textContent = msg;
      t.classList.add('show');
      setTimeout(()=>t.classList.remove('show'),3000);
    }
    addToCartBtn.addEventListener('click', ()=>{
      const type = (document.querySelector('input[name="productType"]:checked')||{}).value || 'print';
      const theme = themeInput.value.trim();
      const svg = previewArea.innerHTML;
      const price = parseFloat(priceDisplay.textContent.replace('$','')) || 6.99;
      const newItem = {
        id: 'custom_' + Date.now(),
        type,
        theme,
        svgPreview: svg,
        price,
        createdAt: new Date().toISOString()
      };
      cart.push(newItem);
      localStorage.setItem('lunaRitualsCart', JSON.stringify(cart));
      cartBadge.textContent = String(cart.length);
      showToast('Added to cart!');
      closeModal();
    });

    // Share to TikTok button
    const shareTikTokBtn = document.getElementById('shareTikTokBtn');
    shareTikTokBtn?.addEventListener('click', async ()=> {
      const theme = themeInput.value.trim();
      const url = window.location.href.split('#')[0];
      const text = `Check out my custom "${theme}" affirmation from Luna Rituals! ‚ú® #LunaRituals #Affirmations #Wellness #ThatGirl`;
      if (navigator.share) {
        try {
          await navigator.share({ title: 'Luna Rituals - ' + theme, text, url });
          showToast('Shared! üéâ');
          if (window.trackTikTokEvent) { window.trackTikTokEvent('Share', { content_type: 'product', method: 'native' }); }
        } catch(err) { if (err.name !== 'AbortError') console.error('Share failed:', err); }
      } else {
        try {
          await navigator.clipboard.writeText(url);
          showToast('Link copied! Share on TikTok üìã');
          if (window.trackTikTokEvent) { window.trackTikTokEvent('Share', { content_type: 'product', method: 'clipboard' }); }
        } catch(err) { alert('Copy this link to share: ' + url); }
      }
    });

    // Download design button
    const downloadBtn = document.getElementById('downloadBtn');
    downloadBtn?.addEventListener('click', function() {
      const svg = previewArea.querySelector('svg');
      if (!svg) { showToast('No design to download yet'); return; }
      const canvas = document.createElement('canvas');
      const ctx = canvas.getContext('2d');
      const svgString = new XMLSerializer().serializeToString(svg);
      const svgBlob = new Blob([svgString], {type: 'image/svg+xml;charset=utf-8'});
      const url = URL.createObjectURL(svgBlob);
      const img = new Image();
      img.onload = function() {
        canvas.width = 1200; canvas.height = 1500;
        ctx.fillStyle = '#fff';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
        canvas.toBlob(function(blob) {
          const a = document.createElement('a');
          a.href = URL.createObjectURL(blob);
          const themeSlug = themeInput.value.trim().replace(/[^a-z0-9]/gi, '-').toLowerCase();
          a.download = `luna-rituals-${themeSlug}-${Date.now()}.png`;
          document.body.appendChild(a); a.click(); document.body.removeChild(a);
          showToast('Downloaded! üì•');
          URL.revokeObjectURL(url);
          if (window.trackTikTokEvent) { window.trackTikTokEvent('Download', { content_type: 'product' }); }
        });
      };
      img.src = url;
    });

    // Initialize cart badge on load
    cartBadge.textContent = String(cart.length);

    // Cart Management Overlay
    const cartBtn = document.getElementById('cartBtn');
    const cartModal = document.getElementById('cartModal');
    const cartModalBackdrop = document.getElementById('cartModalBackdrop');
    const cartModalClose = document.getElementById('cartModalClose');
    const cartItems = document.getElementById('cartItems');
    const cartEmpty = document.getElementById('cartEmpty');
    const cartSummary = document.getElementById('cartSummary');
    const cartTotal = document.getElementById('cartTotal');
    const clearCartBtn = document.getElementById('clearCartBtn');

    function openCartModal(){
      cartModal.classList.add('open');
      cartModal.setAttribute('aria-hidden','false');
      document.body.style.overflow='hidden';
      renderCart();
    }

    function closeCartModal(){
      cartModal.classList.remove('open');
      cartModal.setAttribute('aria-hidden','true');
      document.body.style.overflow='';
    }

    function renderCart(){
      if(cart.length === 0){
        cartEmpty.style.display = 'block';
        cartSummary.style.display = 'none';
        return;
      }

      cartEmpty.style.display = 'none';
      cartSummary.style.display = 'block';

      cartItems.innerHTML = cart.map((item, index) => `
        <div style="display:flex; gap:16px; padding:16px; border:1px solid rgba(0,0,0,.06); border-radius:12px; margin-bottom:12px;">
          <div style="width:80px; height:100px; background:#f7f5f1; border-radius:8px; display:flex; align-items:center; justify-content:center; overflow:hidden;">
            ${item.svgPreview}
          </div>
          <div style="flex:1; display:flex; flex-direction:column; justify-content:space-between;">
            <div>
              <h4 style="margin:0 0 4px; font-size:16px; font-weight:600;">${item.theme}</h4>
              <p style="margin:0; font-size:14px; color:var(--ink);">${item.type.charAt(0).toUpperCase() + item.type.slice(1)}</p>
            </div>
            <div style="display:flex; justify-content:space-between; align-items:center;">
              <span class="price" style="font-weight:700;">$${item.price.toFixed(2)}</span>
              <button onclick="removeCartItem(${index})" style="background:none; border:none; color:#dc2626; cursor:pointer; font-size:14px;">Remove</button>
            </div>
          </div>
        </div>
      `).join('');

      const total = cart.reduce((sum, item) => sum + item.price, 0);
      cartTotal.textContent = `$${total.toFixed(2)}`;
    }

    window.removeCartItem = function(index){
      cart.splice(index, 1);
      localStorage.setItem('lunaRitualsCart', JSON.stringify(cart));
      cartBadge.textContent = String(cart.length);
      renderCart();
      showToast('Removed from cart');
    };

    window.closeCartModal = function(){
      closeCartModal();
    };

    cartBtn.addEventListener('click', (e)=>{
      e.preventDefault();
      if(cart.length > 0){
        openCartModal();
          } else {
        showToast('Your cart is empty');
      }
    });

    cartModalBackdrop.addEventListener('click', closeCartModal);
    cartModalClose.addEventListener('click', closeCartModal);
    clearCartBtn.addEventListener('click', ()=>{
      if(confirm('Clear your entire cart?')){
        cart = [];
        localStorage.setItem('lunaRitualsCart', JSON.stringify(cart));
        cartBadge.textContent = '0';
        renderCart();
        showToast('Cart cleared');
      }
    });

    document.addEventListener('keydown', (e)=>{
      if(e.key==='Escape' && cartModal.classList.contains('open')) closeCartModal();
    });
  </script>

  <!-- Cart Management Overlay -->
  <div class="modal" id="cartModal" aria-hidden="true" role="dialog" aria-modal="true">
    <div class="backdrop" id="cartModalBackdrop"></div>
    <div class="modal-card" style="max-width:600px; max-height:70vh;" role="document">
      <button class="modal-close" id="cartModalClose" aria-label="Close">‚úï</button>
      <div style="padding:28px;">
        <h2 class="gen-title" id="cartTitle">Your Cart</h2>
        <div id="cartItems" style="margin-top:16px;">
          <!-- Cart items will be populated here -->
        </div>
        <div id="cartEmpty" style="display:none; text-align:center; padding:40px 20px; color:var(--ink);">
          <p>Your cart is empty</p>
          <a href="#shop" class="btn-primary" onclick="closeCartModal(); return false;">Browse Products</a>
        </div>
        <div id="cartSummary" style="display:none; margin-top:20px; padding-top:20px; border-top:1px solid rgba(0,0,0,.08);">
          <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:16px;">
            <strong>Total:</strong>
            <span class="price-lg" id="cartTotal">$0.00</span>
          </div>
          <div class="gen-actions">
            <button id="clearCartBtn" class="btn-ghost-wide">Clear Cart</button>
            <button class="btn-primary-wide" disabled>Checkout (Coming Soon)</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
